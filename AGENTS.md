# AGENTS.md

本文件用于指导 Codex/自动化代理在本仓库中的协作与修改规范。

## 基本约定
- 目标：保证功能稳定、代码可维护、风格统一。
- 默认语言：中文。
- 禁止无意义重构；改动要与需求强相关。

## 目录说明
- `lib/pages` 页面
- `lib/component` 组件
- `lib/store` MobX 状态
- `lib/utils` 工具函数
- `lib/config` 配置与主题

## 开发规范
- Flutter/Dart：保持空安全与 lint 规范。
- 主题色：统一从 `lib/config/app_theme.dart` 读取。
- 组件样式：优先复用现有组件，必要时新增。

## 组件注释规范（`lib/component`）
- 覆盖范围：`公共 API + 复杂逻辑`。
- 语言：中文为主，必要术语可保留英文（如 MobX、Waveform、Store）。
- 注释类型：
  - `///`：用于类、构造参数、公开方法/回调的文档注释。
  - `//`：用于复杂分支、状态同步、边界条件、性能权衡说明。
- 必须写注释的场景：
  - Widget 类职责（该组件做什么）。
  - 语义不自明的参数（含义、单位、触发时机、取值范围）。
  - 异步状态流（如 loading/saving/recording/selectedId 的变更链路）。
  - 底部弹窗/滚动/约束等适配策略（为什么这样布局）。
  - 资源缺失、空数据、mounted 检查等边界处理。
- 不写或清理的场景：
  - 与代码重复的无效注释。
  - 注释掉的大段旧代码。
  - 无责任人和时间的 TODO。
- TODO 规范：统一为 `// TODO(author, yyyy-mm-dd): ...`。

## 修改流程
1) 先读相关文件，理解当前逻辑。
2) 小步修改，避免破坏性变更。
3) 如有生成文件（如 `.g.dart`），尽量保持同步。

## 测试/验证
- 基本验证：`flutter analyze`
- 运行验证：`flutter run`

## 常见注意
- 音频播放与节拍计时需保证低延迟和稳定性。
- 底部弹窗高度不要写死，使用内容自适应。
